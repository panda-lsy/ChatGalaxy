<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>数据管理器 - ChatGalaxy</title>
    <link href="js/lib/remixicon/remixicon.css" rel="stylesheet">
    <link rel="stylesheet" href="css/data-manager.css">
</head>
<body>
    <!-- 背景装饰 - 与主页面一致 -->
    <div class="bg-decoration">
        <div class="bg-circle circle-1"></div>
        <div class="bg-circle circle-2"></div>
        <div class="bg-circle circle-3"></div>
    </div>

    <!-- 主容器 -->
    <div class="manager-container">
        <!-- 头部 -->
        <header class="manager-header">
            <div class="header-content">
                <div class="header-left">
                    <button class="back-btn" onclick="window.location.href='index.html'" title="返回星系">
                        <i class="ri-arrow-go-back-line"></i>
                    </button>
                    <div class="header-title">
                        <h1><i class="ri-database-2-line"></i> 数据管理器</h1>
                        <p>管理您的聊天数据集</p>
                    </div>
                </div>
                <div class="header-actions">
                    <button class="action-btn secondary" onclick="createNewDataset()">
                        <i class="ri-add-circle-line"></i>
                        <span>创建空数据集</span>
                    </button>
                    <button class="action-btn secondary" onclick="loadDemoDataset()">
                        <i class="ri-magic-line"></i>
                        <span>演示数据</span>
                    </button>
                    <button class="action-btn secondary" onclick="refreshDatasetList()">
                        <i class="ri-refresh-line"></i>
                        <span>刷新</span>
                    </button>
                </div>
            </div>
        </header>

        <!-- 主内容区 -->
        <main class="manager-main">
            <!-- 导入面板 -->
            <section class="import-section">
                <div class="section-header" onclick="toggleImportPanel()">
                    <h2><i class="ri-upload-cloud-line"></i> 导入数据集</h2>
                    <button class="collapse-btn">
                        <i class="ri-arrow-down-s-line" id="import-panel-icon"></i>
                    </button>
                </div>

                <div class="import-content" id="import-panel-content">
                    <!-- 上传区域 -->
                    <div class="upload-zone" id="upload-zone">
                        <div class="upload-icon">
                            <i class="ri-cloud-upload-line"></i>
                        </div>
                        <div class="upload-text">拖拽JSON文件到此处，或点击选择</div>
                        <div class="upload-hint">支持最大10MB的JSON文件</div>
                        <input type="file" id="file-input" accept=".json" style="display: none;">
                    </div>

                    <!-- 文件信息 -->
                    <div class="file-info" id="file-info" style="display: none;">
                        <i class="ri-file-text-line"></i>
                        <span id="file-name"></span>
                    </div>

                    <!-- 验证警告 -->
                    <div class="validation-warnings" id="validation-warnings" style="display: none;">
                        <h4><i class="ri-alert-line"></i> 导入警告</h4>
                        <ul id="validation-warning-list"></ul>
                    </div>

                    <!-- 数据集表单 -->
                    <div class="dataset-form" id="dataset-form" style="display: none;">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">数据集名称 <span class="required">*</span></label>
                                <input type="text" id="dataset-name" class="form-input" placeholder="例如：我的聊天记录">
                            </div>

                            <div class="form-group">
                                <label class="form-label">主题颜色</label>
                                <div class="color-selector" id="color-selector">
                                    <div class="color-option selected" style="background: #3498db;" data-color="#3498db" onclick="selectColor(this)"></div>
                                    <div class="color-option" style="background: #10b981;" data-color="#10b981" onclick="selectColor(this)"></div>
                                    <div class="color-option" style="background: #f59e0b;" data-color="#f59e0b" onclick="selectColor(this)"></div>
                                    <div class="color-option" style="background: #ef4444;" data-color="#ef4444" onclick="selectColor(this)"></div>
                                    <div class="color-option" style="background: #8b5cf6;" data-color="#8b5cf6" onclick="selectColor(this)"></div>
                                    <div class="color-option" style="background: #ec4899;" data-color="#ec4899" onclick="selectColor(this)"></div>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">描述（可选）</label>
                            <textarea id="dataset-description" class="form-textarea" placeholder="简单描述这个数据集..." rows="3"></textarea>
                        </div>

                        <div class="form-group">
                            <label class="form-label">标签</label>
                            <div class="tag-selector" id="tag-selector">
                                <div class="tag-option" onclick="toggleTag(this)">游戏</div>
                                <div class="tag-option" onclick="toggleTag(this)">工作</div>
                                <div class="tag-option" onclick="toggleTag(this)">学习</div>
                                <div class="tag-option" onclick="toggleTag(this)">生活</div>
                                <div class="tag-option" onclick="toggleTag(this)">社交</div>
                                <div class="tag-option" onclick="toggleTag(this)">其他</div>
                            </div>
                        </div>

                        <!-- 进度条 -->
                        <div class="progress-container" id="import-progress" style="display: none;">
                            <div class="progress-bar-bg">
                                <div id="progress-bar-fill" class="progress-bar-fill" style="width: 0%;"></div>
                            </div>
                            <div id="progress-text" class="progress-text">准备导入...</div>
                        </div>

                        <div class="form-actions">
                            <button class="btn btn-primary" id="import-btn" onclick="startImport()">
                                <i class="ri-upload-line"></i>
                                开始导入
                            </button>
                            <button class="btn btn-secondary" onclick="resetImportForm()">
                                <i class="ri-refresh-line"></i>
                                重置
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 数据集列表 -->
            <section class="datasets-section">
                <div class="section-header">
                    <h2><i class="ri-folder-line"></i> 我的数据集</h2>
                    <span class="dataset-count" id="dataset-count">0 个数据集</span>
                </div>

                <div id="dataset-list" class="dataset-list">
                    <!-- 数据集卡片将动态生成 -->
                </div>
            </section>
        </main>
    </div>

    <!-- Toast 提示 -->
    <div class="toast-container" id="toast-container">
        <div class="toast toast-success" id="toast-success">
            <i class="ri-checkbox-circle-line"></i>
            <span></span>
        </div>
        <div class="toast toast-error" id="toast-error">
            <i class="ri-error-warning-line"></i>
            <span></span>
        </div>
        <div class="toast toast-warning" id="toast-warning">
            <i class="ri-alert-line"></i>
            <span></span>
        </div>
        <div class="toast toast-info" id="toast-info">
            <i class="ri-information-line"></i>
            <span></span>
        </div>
    </div>

    <!-- 加载脚本 -->
    <script src="js/config.js"></script>
    <script src="js/logger.js"></script>
    <script src="js/error-handler.js"></script>
    <script src="js/data-manager.js"></script>
    <script src="js/data-import.js"></script>
    <script src="js/processors/text-processor.js"></script>
    <script src="js/data-manager-ui.js"></script>
</body>
</html>
